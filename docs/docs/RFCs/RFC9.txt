/////////////////////////////////////////////////////////////////////////////
SELECT * 
FROM (RESERVA INNER JOIN OFERTA ON RESERVA.IDOFERTA = OFERTA.IDOFERTA) 
WHERE RESERVA.FECHARESERVA <= OFERTA.FECHAPUBLICACION+30; 
/////////////////////////////////////////////////////////////////////////////

//RFC9: Ofertas que despues de 30 dias de publicadas no han sido reservadas
SELECT ID_OFERTA FROM(
(SELECT OFERTA.IDOFERTA AS ID_OFERTA FROM OFERTA)
MINUS
(SELECT OFERTA.IDOFERTA 
FROM (RESERVA INNER JOIN OFERTA ON RESERVA.IDOFERTA = OFERTA.IDOFERTA) 
WHERE RESERVA.FECHARESERVA <= OFERTA.FECHAPUBLICACION+30)); 

//RFC9: Ofertas que tienen intervalos de 30 dias entre reservas
SELECT R1.IDOFERTA AS ID_OFERTA
FROM (RESERVA R1 INNER JOIN RESERVA R2 ON R1.IDOFERTA = R2.IDOFERTA AND R1.FECHARESERVA < R2.FECHARESERVA)
WHERE R1.FECHARESERVA + 30 <= R2.FECHARESERVA
ORDER BY R1.IDOFERTA ASC, R1.FECHARESERVA, R2.FECHARESERVA;

//RFC9: Ofertas que a la fecha actual despues de la ultima reserva han pasado 30 dias sin ser reservadas 
SELECT ID_OFERTA FROM (
SELECT OFERTA.IDOFERTA AS ID_OFERTA, MAX(RESERVA.FECHARESERVA) FECHA_ULTIMA_RESERVA
FROM (RESERVA INNER JOIN OFERTA ON RESERVA.IDOFERTA = OFERTA.IDOFERTA) GROUP BY OFERTA.IDOFERTA)
WHERE FECHA_ULTIMA_RESERVA+30 <= CURRENT_TIMESTAMP;
++++++++++++++++++++++++++++++++++++++RFC9 COMPLETO++++++++++++++++++++++++++++++++++++++
SELECT * FROM
(
        ((SELECT OFERTA.IDOFERTA AS ID_OFERTA FROM OFERTA)
        MINUS
        (SELECT OFERTA.IDOFERTA 
            FROM (RESERVA INNER JOIN OFERTA ON RESERVA.IDOFERTA = OFERTA.IDOFERTA) 
        WHERE RESERVA.FECHARESERVA <= OFERTA.FECHAPUBLICACION+30))
UNION 
        (SELECT R1.IDOFERTA AS ID_OFERTA
         FROM (RESERVA R1 INNER JOIN RESERVA R2 ON R1.IDOFERTA = R2.IDOFERTA AND R1.FECHARESERVA < R2.FECHARESERVA)
        WHERE (R1.FECHARESERVA + 30 <= R2.FECHARESERVA))
UNION   
        (SELECT ID_OFERTA FROM (
            SELECT OFERTA.IDOFERTA AS ID_OFERTA, MAX(RESERVA.FECHARESERVA) FECHA_ULTIMA_RESERVA
             FROM (RESERVA INNER JOIN OFERTA ON RESERVA.IDOFERTA = OFERTA.IDOFERTA) GROUP BY OFERTA.IDOFERTA)
        WHERE FECHA_ULTIMA_RESERVA+30 <= CURRENT_TIME